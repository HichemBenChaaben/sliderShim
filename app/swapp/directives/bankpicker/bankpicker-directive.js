"use strict";define(["swapp","socket-factory","ui-select","ui-bootstrap","uiGrid"],function(e){e.registerDirective("swBankPicker",["$rootScope","socket","$filter",function(e,t,n){return{templateUrl:"/swapp/directives/bankpicker/bankpicker.tpl.html",restrict:"E",replace:!0,require:"^ngModel",scope:{bank:"=ngModel"},link:function(n,a,c){n.selectedBank={},n.branchStates=[],n.gridBranchList=[],n.dirTranslations={},n.banks=[],n.showNoStatesMsg=!0,n.showSelectBankHelpMsg=!0,n.hasLoaded=!1,n.$on("fetchBankPickerData",function(e){n.initData()}),n.getLocationsByBank=function(e){var a={task_request:"Bank/getLocations",data:{Mnemonic:e}};t.get(a).then(function(e){n.showSelectBankHelpMsg=!1,n.branchStates=[],n.gridBranchList=[];for(var t in e)n.branchStates.push(e[t]);1===n.branchStates.length&&(n.selectedBank._selectedState=n.branchStates[0],n.stateChange())})},n.isBankSelected=function(e){return e&&n.selectedBank?e.Mnemonic===n.selectedBank.Mnemonic:!1},n.getBankList=function(){var e={task_request:"Company/getBanks"};t.get(e).then(function(e){n.banks=[];for(var t in e)n.banks.push(e[t])})},n.initData=function(){n.getBankList()},n.onBankSelect=function(e){n.selectedBank=e,n.gridBranchList=[],n.branchStates=[],n.getLocationsByBank(e.Mnemonic)};n.stateChange=function(){n.hasLoaded=!1;var e={task_request:"Bank/getBranchesByLocation",data:{BankName:n.selectedBank.BankName,BankLocation:n.selectedBank._selectedState.locationpc}};t.get(e).then(function(e){if(n.gridBranchList=[],!_.isEmpty(e))for(var t in e)n.gridBranchList.push(e[t]);n.hasLoaded=!0,n.showNoStatesMsg=0===n.gridBranchList.length})},n.onBankBranchSelect=function(t){n.bank=t,n.bank.accForm=n.selectedBank.Accform,n.bank.accSample=n.selectedBank.Accsample,e.$broadcast("bankBranchSelected",n.bank)}}}}])});